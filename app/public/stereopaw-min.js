HOST="https://www.stereopaw.com",EXTENSION_ID="gcgoenndigjegpgpfnnmgfnbiollgimk";var MODE={MARKLET:0,EXTENSION:1},SB=function(){var a,b=null,c=null,d=6,e=d;return{init:function(){b=this,b.Util.load_jQuery(),c=setInterval(function(){if(void 0==$&&null!=jQuery&&($=jQuery),"undefined"==typeof jQuery)return!1;clearInterval(c),c=null,b.start()},150)},start:function(){b.service=b.Service.getService(),a=window.chrome&&document.getElementById("sb-script").getAttribute("mode")?MODE.EXTENSION:MODE.MARKLET,a!=MODE.MARKLET||document.getElementById("sb-app")||("NA"==b.service?b.Page.insert_error_page():b.Page.insert_page(),b.events()),b.update()},events:function(){$("#sb-close").bind("click",function(){clearInterval(document.getElementById("sb-script").getAttribute("timer")),b._interval=null,$("#sb-submit-button").unbind("click"),$("#sb-close").unbind("click"),$("#sb-script").remove(),$("#sb-style").remove(),$("#sb-app").remove()}),$("#sb-submit-button").bind("click",function(a){a.preventDefault(),window.open(b.Track.getURL(),"stereopaw","top=0,left=0,width=600, height=675"),$("#sb-close").click()}),$("#sb-display-bar").mouseover(function(a){$("#sb-display-seek").show()}),$("#sb-display-bar").mouseout(function(a){$("#sb-display-seek").hide()}),$("#sb-display-bar").mousemove(function(a){var b=$(this).parent().offset(),c=a.pageX-b.left;$("#sb-display-seek").css("left",c+"px")}),$("#sb-display-bar").click(function(a){var c=$(this).parent().offset(),d=a.pageX-c.left;b.Data.seek(d/$("#sb-display-bar").width())})},update:function(){b._interval=setInterval(function(){b.Data.setTrack(a,b.service,b.Track),a==MODE.MARKLET?b.render():b.sendExtension()},400),document.getElementById("sb-script").setAttribute("timer",b._interval)},sendExtension:function(){var a;a="NA"==b.service?{error:!0}:{track:b.Track.toJSON()};var c=function(a){a.shutdown&&(clearInterval(document.getElementById("sb-script").getAttribute("timer")),$("#sb-script").remove()),a.alive&&(e=d)};chrome.runtime.sendMessage(EXTENSION_ID,a,c),(e-=1)<=0&&(clearInterval(document.getElementById("sb-script").getAttribute("timer")),$("#sb-script").remove())},render:function(){$("#sb-app").is(":hidden")&&$("#sb-app").fadeIn(),"NA"!=b.service&&(b.Track.getTitle()?document.getElementById("sb-track-title").innerHTML=b.Track.getTitle():document.getElementById("sb-track-title-label").style.display="none",b.Track.getArtist()||(document.getElementById("sb-track-artist-label").style.display="none"),document.getElementById("sb-track-artist").innerHTML=b.Track.getArtist(),b.Track.getTimeFormat()?document.getElementById("sb-time").innerHTML=b.Track.getTimeFormat():document.getElementById("sb-track-time-label").style.display="none")}}}();SB.Util=function(){function a(a){return a.toFixed().length>1?a.toFixed():"0"+a.toFixed()}function b(b,c,d){return b<1?c+":"+a(d):b+":"+a(c)+":"+a(d)}var c={};return c.textToSecs=function(a,b,c){var d=0;return a&&(d+=parseInt(3600*a[0].match(/\d+/)[0])),b&&(d+=parseInt(60*b[0].match(/\d+/)[0])),c&&(d+=parseInt(c)),d},c.TimetoMs=function(a){var b=a.split(":"),c=0,d=1;for(console.log(b);b.length;){c+=d*b.pop()*1e3,d*=60}return c},c.toTime=function(a,c){var d="secs"==c?1:1e3,e=Math.floor(a/(3600*d)),f=Math.floor(a/(60*d)-60*e),g=60*(a/(60*d)-60*e-f);return"secs"==c?b(e,f,Math.round(g)):b(e,f,Math.floor(g))},c.load_jQuery=function(){if("undefined"==typeof jQuery){var a=document.createElement("script");a.id="sb-jb",a.type="text/javascript",a.src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js",document.body.appendChild(a)}},c}(),SB.Page=function(){function a(b){css="";for(key in b)b.hasOwnProperty(key)&&"object"==typeof b[key]&&(css+=key+"{"+a(b[key])+"}"),b.hasOwnProperty(key)&&"string"==typeof b[key]&&(css+=key+":"+b[key]+";");return css}function b(a,b){var c=document.createElement(a.type);c.setAttribute(a.attr,a.value),c.innerHTML=b,document.body.appendChild(c)}var c="https://www.stereopaw.com",d=['<div id = "sb-close">',["<img src= "+c+'/icon-close.png width="12px"/>'].join("\n"),"</div>",'<div id="sb-logo">',['<img width="26" src= '+c+"/stereopaw-logo-main.png>"].join("\n"),"</div>",'<div id = "sb-title">',["<img src= "+c+"/stereopaw-marklet-title.png>"].join("\n"),"</div>"].join("\n"),e=[d,'<div id = "sb-track">',['<div id = "sb-track-title-label" class = "sb-label">Title</div>','<div id = "sb-track-title"></div>','<div id = "sb-track-artist-label" class = "sb-label">Artist</div>','<div id = "sb-track-artist"></div>','<div id = "sb-track-time-label" class = "sb-label">Timestamp</div>','<div id = "sb-time"></div>'].join("\n"),"</div>",'<div id = "sb-player">',['<div id = "sb-display-bar">',['<div id = "sb-display-bar-elapsed"></div>','<div id = "sb-display-seek"></div>'].join("\n"),"</div>"].join("\n"),"</div>",'<div id = "sb-submit">',['<div id="sb-submit-button">Submit</div>'].join("\n"),"</div>"].join("\n"),f=[d,'<div id = "sb-error">',['<div class="sb-service"> This website is not yet supported </div>','<div class="sb-service"> Sorry! </div>'].join("\n"),"</div>"].join("\n"),g={"#sb-app":{position:"fixed !important",top:"50px !important",right:"0 !important",width:"300px","background-color":"#fff",border:"1px solid #aaa","z-index":"99999999999999999","text-align":"left",display:"none"},"#sb-error":{margin:"10px 0px"},".sb-service":{padding:"10px"},"#sb-title":{padding:"10px","margin-top":"8px","border-bottom":"1px solid #000","margin-left":"10px","margin-right":"10px"},"#sb-track":{"margin-left":"10px","font-size":"14px","padding-top":"10px","margin-right":"10px",font:'12px/1.4 "Lucida Grande","Lucida Sans Unicode","Lucida Sans",Garuda,Verdana,Tahoma,sans-serif;'},"#sb-close":{float:"right",padding:"8px","padding-right":"6px",cursor:"pointer"},"#sb-logo":{float:"left",padding:"8px","padding-left":"10px","margin-right":"4px"},"#sb-time":{"font-size":"14px"},"#sb-display-bar":{width:"100%",cursor:"pointer",height:"10px","background-color":"#000",display:"none"},"#sb-display-bar-elapsed":{width:"0%",height:"8px","background-color":"#aaa"},".sb-label":{"font-size":"12px","margin-top":"10px",color:"#a2a2a2"},"#sb-track-title":{"font-size":"18px"},"#sb-track-artist":{"font-size":"14px"},"#sb-display-seek":{position:"relative",top:"-8px",width:"2px",height:"10px","background-color":"#eee111",display:"none"},"#sb-submit":{width:"100%;","margin-top":"20px"},"#sb-submit-button":{background:"#0066cc",color:"white",padding:"10px",margin:"10px","text-align":"center","font-size":"14px",cursor:"pointer"}};return{insert_page:function(){b({type:"div",attr:"id",value:"sb-app"},e),b({type:"style",attr:"id",value:"sb-style"},a(g))},insert_error_page:function(){b({type:"div",attr:"id",value:"sb-app"},f),b({type:"style",attr:"id",value:"sb-style"},a(g))}}}(),SB.Service=function(){function a(){c.some(function(a){if(m=a.exec(e))return d=m[1]})}var b={},c=[/^https?:\/\/.*(mixcloud).com/g,/^https?:\/\/.*(soundcloud).com/g,/^https?:\/\/.*(youtube).com/g,/^https?:\/\/.*(spotify).com/g,/^https?:\/\/.*(stereopaw).com/g],d=null,e=window.location.origin;return b.getService=function(){return null==d&&a(),d?d.toLowerCase():"NA"},b}(),SB.Track=function(){_url="https://www.stereopaw.com/tracks/new";var a={},b="",c="",d="",e="",f="",g="",h="",i="",j="",k="",l="",m="";return _service="",_artwork_url="",a.set=function(a,j,k,n,o,p,q,r,s,t,u){c=a,d=j,b=k,e=n,f=o,g=p,i=q,h=r,m=s,_service=t,_artwork_url=u,l=p/o},a.getURL=function(){return _url+"?track[track_id]="+encodeURIComponent(c)+"&track[artist]="+encodeURIComponent(d)+"&track[title]="+encodeURIComponent(b)+"&track[page_url]="+encodeURIComponent(h)+"&track[profile_url]="+encodeURIComponent(e)+"&track[timeformat]="+encodeURIComponent(this.getTimeFormat())+"&track[timestamp]="+encodeURIComponent(g)+"&track[duration]="+encodeURIComponent(f)+"&track[shareable]="+encodeURIComponent(m)+"&track[service]="+encodeURIComponent(_service)+"&track[artwork_url]="+encodeURIComponent(_artwork_url)+"&track[subtrack]="+encodeURIComponent(j)+"&track[subartist]="+encodeURIComponent(k)},a.getTitle=function(){return b},a.getArtist=function(){return d},a.getTimeFormat=function(){return i},a.getElapsed=function(){return l},a.getDuration=function(){return f},a.toJSON=function(){return{track_id:c,title:b,artist:d,profile_url:e,duration:f,timestamp:g,page_url:h,timeformat:i,subtrack:j,subartist:k,elapsed:l,shareable:m,service:_service,artwork_url:_artwork_url,url:a.getURL()}},a}(),SB.Data=function(){function a(a,b,c){try{return a()}catch(a){try{return b()}catch(a){return c}}}function b(){e.set(null,"Please select something to play","Nothing Loaded",null,null,0,"0:00",null,!1,d,null),$("#sb-submit-button").css("display","none")}function c(){_mode==MODE.MARKLET&&(document.getElementById("sb-track-title-label").style.display="block",document.getElementById("sb-track-artist-label").style.display="block",$("#sb-submit-button").css("display","block"))}var d=null,e=null,f=null;_mode=null;var g=g||{};_sc_load_status=0;var h={soundcloud:function(){var a=!1;if(_isPlaying=$(".playControls__playPauseSkip .playing"),!_isPlaying)return void b();c();var f=$("title"),h="function"==typeof f.text?f.text():f.text;i=g.title;var i,j,k=h.split(/ by /);if(1==k.length?(k=h.split(/-/),1==k.length?i=k[0].trim():(j=k[0].trim(),i=k[1].trim())):(i=k[0].trim(),j=k[1].trim()),i||(i=$(".playbackSoundBadge__title > a").attr("title").trim()),j||(j=$(".playbackSoundBadge__titleContextContainer > a")[0].innerText.trim()),g.title=g.track||i,0!=_sc_load_status||a||(_sc_load_status=1,$.get("https://api.soundcloud.com/tracks",{q:h+" "+j,client_id:"82d79419cef128093cfca50715c23cd7"},function(b){0==b.length&&(a=!0,_sc_load_status=2);for(var c=0;c<b.length;c++){var d=b[c];"track"==d.kind&&d.title+" by "+d.user.username==k.join(" by ")&&(g=d,_sc_load_status=2)}})),g.title!=i&&2==_sc_load_status&&(_sc_load_status=0),2==_sc_load_status){var l=$(".playbackTimeline__timePassed > span")[1].innerText,m=$(".playbackTimeline__duration > span")[1].innerText;g.user={username:j,permalink_url:g.user&&g.user.permalink_url||$(".playbackSoundBadge__titleLink")[0].href};var n=g.artwork_url||g.user.avatar_url;n=null==n?"":n.replace("-large.jpg","-t200x200.jpg"),e.set(g.id,g.user.username,g.title,g.user.permalink_url.replace(/^(http|https):\/\//,"//"),SB.Util.TimetoMs(m),SB.Util.TimetoMs(l),SB.Util.toTime(SB.Util.TimetoMs(l)/1e3,"secs"),g.user.permalink_url.replace(/^(http|https):\/\//,"//"),"public"==g.sharing,d,n.replace(/^(http|https):\/\//,"//")),console.log(e.toJSON()),console.log(e.getElapsed())}},youtube:function(){null==f&&(f=document.getElementById("movie_player"));var g=a(function(){return f.getVideoData().author},function(){return""},""),h=a(function(){return $("title")[0].innerText},function(){return f.getVideoData().title},""),i=a(function(){return f.getCurrentTime()},function(){return 0},0),j=a(function(){return f.getDuration()},function(){return 0},0);if(c(),f.getVideoData().video_id,!1)return void b();e.set(f.getVideoData().video_id,g,h,("https://www.youtube.com/watch?v="+f.getVideoData().video_id).replace(/^(http|https):\/\//,"//"),j,i,SB.Util.toTime(i,"secs"),("https://www.youtube.com/watch?v="+f.getVideoData().video_id).replace(/^(http|https):\/\//,"//"),!0,d,"//img.youtube.com/vi/"+f.getVideoData().video_id+"/0.jpg")},stereopaw:function(){if(!app.current_track)return void b();c(),e.set(app.current_track.track_id,app.current_track.artist,app.current_track.title,app.current_track.profile_url,app.current_track.duration,app.current_track.elapsed,app.current_track.timeformat,app.current_track.page_url,!0,app.current_track.service,app.current_track.artwork_url)},NA:function(){return"NA"}},i={soundcloud:{seek:function(a){f.seek(a*e.getDuration())},pause:function(){},play:function(){}},youtube:{seek:function(a){f.seekTo(a*e.getDuration())},pause:function(){},play:function(){}},NA:function(){return"NA"}},j={};return j.setTrack=function(a,b,c){_mode=a,d=b,e=c,h[d]()},j.seek=function(a){i[d].seek(a)},j}(),SB.init();